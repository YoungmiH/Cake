(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{468:function(e,t,n){"use strict";n.r(t);var o=n(4),a=n.n(o),s=n(5),i=n(2),r=n.n(i),u=n(777),l=n(1),c=n.n(l),d=n(773),p=n(71),h=function(e){var t,n,o=(t=e,n={},[].forEach.call(t.attributes,(function(e){if(/^data-/.test(e.name)){var t=e.name.replace("data-","").replace(/-(.)/g,(function(e,t){return t.toUpperCase()}));n[t]=e.value}})),n),i=r.a.get(o,"hashId",""),l=r.a.get(o,"page","");if(window.karma=window.karma||{},window.karma.cmd=window.karma.cmd||[],"unsubscribe"===l){var h=p.a.data(),f={contentIsPost:h.contentIsPost,contentShownOnPlatform:h.contentShownOnPlatform,contentSyndicated:h.contentSyndicated,contentType:"other",search:h.search,title:h.title,meredithBrand:h.meredithBrand,registrationsource:"000",userDecisionArea:"Subscribe",metric9:"1",category:"auth0"},m=function(){window.location.href="/?banner=newsletterchg"},b=function(e){var t=c()("input[name=unsubscribe-survey-modal-answer]:checked"),n=c()(".comment").val()?c()(".comment").val():"",o={answers:[]};["Newsletter ID","Hash ID","Survey Question","Leave a Comment"].forEach((function(e){var a={questionId:null,answerIds:[]};switch(e){case"Newsletter ID":if(a.questionId="Newsletter ID","unsubscribe"===l){var s=c()("#unsubscribedId")?c()("#unsubscribedId").val():"";a.answerIds.push(s)}else{var r=c()("#newsletterForm").find('input[type="checkbox"]');r.each((function(e){var t=c()(r[e]);t.is(":checked")||a.answerIds.push(t.val())}))}break;case"Hash ID":a.questionId="Hash ID",a.answerIds.push(i);break;case"Survey Question":a.questionId=c()(".unsubscribe-survey-modal-question")[0].innerText,t.length&&a.answerIds.push(t[0].value);break;case"Leave a Comment":a.questionId="Leave a Comment",a.answerIds.push(n)}o.answers.push(a)})),function(e,t){c.a.ajax({url:Object(d.a)("/user-proxy/unsubscribe-survey"),type:"POST",data:e,success:t})}(o,e)},v=function(){var e=new u.a(c()(".unsubscribe-survey-modal"),"unsubscribe-survey-modal");setTimeout((function(){e.open(),a()(s.m).subscribe((function(e,t){0===t.closest(".unsubscribe-survey-modal").length||t[0].classList.contains("close-modal-link")?(e.preventDefault(),m()):t[0].classList.contains("submit")&&(e.preventDefault(),b(m))})),c()(".unsubscribe-survey-modal button.close").on("click",(function(e){e.preventDefault(),m()}))}),0)};c()("#newsletterUnsubscribeForm").on("submit",(function(e){e.preventDefault();var t=c()('input[name="newsletterId"]').val();!function(e,t){c.a.ajax({url:Object(d.a)("/element-api/content-proxy/updateNewslettersByHashId"),type:"POST",data:e,complete:t})}({hashId:i,optout:t},v),f.label=t,f.userDecisionArea="Unsubscribe",window.analytics.track("newsletter unsubscribe page",f)})),c()(".newsletter-management .unsubscribe").on("click",(function(e){e.preventDefault(),c()("#newsletterUnsubscribeForm").submit()})),c()(".newsletter-management .cancel-page").on("click",(function(e){e.preventDefault(),window.analytics.track("cancel"),window.location.href="/"}))}};t.default=function(){var e=document.getElementById("newsletterManagementConfig");e&&h(e)}},509:function(e,t,n){"use strict";n.r(t);var o=n(1),a=n.n(o),s=n(2),i=n.n(s),r=n(5),u=n(4),l=n.n(u),c=n(773);function d(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var p=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$context=t,this.$photoUploadComponent=t.find(".component.ugc-photo-upload"),this.$alert=t.find(".alert-banner"),this.$uploadedImg=t.find(".js--uploadedImage"),this.$fileInput=t.find(".js--fileInput"),this.$photoMaxUploadSize=this.$fileInput.data("photo-max-upload-size"),this.$favoriteModalLink=a()(".shareicon-favorite-link"),this.contentId=this.$favoriteModalLink.data("content-id"),this.photoUpload={photoId:null,photoUrl:null,step:{getPhotoId:"get_photo_id",uploadPhoto:"photo_upload"}}}var t,n,o;return t=e,(n=[{key:"readUrl",value:function(){var e=this;if(this.$fileInput[0].files&&this.$fileInput[0].files[0]){var t=new FileReader;t.onload=function(t){i.a.set(e.$uploadedImg,"[0].style.backgroundImage","url(".concat(t.target.result,")"))},t.readAsDataURL(this.$fileInput[0].files[0])}}},{key:"showError",value:function(e){this.$alert.removeClass("hidden"),this.$alert.find(".alert-text").text(e)}},{key:"hideError",value:function(){this.$alert.addClass("hidden"),this.$alert.find(".alert-text").text("")}},{key:"photoUploadStatus",value:function(e){e?this.$photoUploadComponent.addClass("uploaded"):this.$photoUploadComponent.removeClass("uploaded")}},{key:"uploadPhoto",value:function(e){var t=this,n=e,o=Object(c.a)("/element-api/content-proxy/photo-upload");a.a.post(o,n,(function(n,o){"success"===o&&(t.hideError(),e.type===t.photoUpload.step.getPhotoId&&(i.a.get(n,"photoId")&&(t.photoUpload.photoId=i.a.get(n,"photoId"),t.photoUpload.photoUrl=i.a.get(n,"imageDestinationUrl")),l()(r.Tb).broadcast()),e.type===t.photoUpload.step.uploadPhoto&&t.photoUploadStatus(!0))})).fail((function(e){e.responseJSON&&e.responseJSON.message.includes("dimensions")?(t.showError(e.responseJSON.message),i.a.set(t.$uploadedImg,"[0].style.backgroundImage","")):t.showError("Error submitting. Please try again."),t.photoUploadStatus(!1)}))}},{key:"photoMetaData",value:function(e){return{type:e,filename:this.$fileInput[0].value.replace(/.*[/\\]/,""),contentId:this.contentId}}},{key:"photoUploadData",value:function(e){return{type:e,photoId:this.photoUpload.photoId,photoData:i.a.get(this.$uploadedImg,"[0].style.backgroundImage"),contentId:this.contentId}}},{key:"events",value:function(){var e=this;l()(r.Sb).subscribe((function(){var t=e.photoMetaData(e.photoUpload.step.getPhotoId);e.uploadPhoto(t)})),l()(r.Tb).subscribe((function(){var t=e.photoUploadData(e.photoUpload.step.uploadPhoto);e.uploadPhoto(t)})),this.$fileInput.on("change",(function(){e.$fileInput[0].value&&(e.$fileInput[0].files[0].size>e.$photoMaxUploadSize?e.showError("Maximum photo size is ".concat(Math.round(e.$photoMaxUploadSize/1024/1024)," MB. Please submit a smaller photo.")):(e.readUrl(e.$fileInput[0],e.$uploadedImg),l()(r.Sb).broadcast()))}))}},{key:"init",value:function(){this.events()}}])&&d(t.prototype,n),o&&d(t,o),e}();t.default=function(){a()(".component.ugc-upload-with-photo").each((function(){new p(a()(this)).init()}))}},773:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var o=n(2),a=n.n(o),s=n(1),i=n.n(s);function r(e){return i()(document.body).data("add-slash")&&!a.a.endsWith(e,"/")?"".concat(e,"/"):e}}}]);
//# sourceMappingURL=28-28.js.map