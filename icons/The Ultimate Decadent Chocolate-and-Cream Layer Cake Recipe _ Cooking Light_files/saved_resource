this.Chicory=this.Chicory||{},this.Chicory["wrapper.full"]=function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="https://prod-cdn.chicoryapp.com/chicory-publisher-sdk/",n(n.s=4)}([function(e,t,n){(function(t){e.exports=t.dom=n(6)}).call(t,n(5))},function(e,t,n){"use strict";for(var i=[],r=0;r<256;++r)i[r]=(r+256).toString(16).substr(1);t.a=function(e,t){var n=t||0,r=i;return[r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]]].join("")}},function(e,t,n){"use strict";t.a=function(){if(!i)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return i(r)};var i="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),r=new Uint8Array(16)},function(e,t,n){"use strict";var i=n(1);t.a=function(e,t,n){var r=function(e,r,o,s){var a=o&&s||0;if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));for(var t=new Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(e)),"string"==typeof r&&(r=function(e){var t=[];return e.replace(/[a-fA-F0-9]{2}/g,function(e){t.push(parseInt(e,16))}),t}(r)),!Array.isArray(e))throw TypeError("value must be an array of bytes");if(!Array.isArray(r)||16!==r.length)throw TypeError("namespace must be uuid string or an Array of 16 byte values");var c=n(r.concat(e));if(c[6]=15&c[6]|t,c[8]=63&c[8]|128,o)for(var l=0;l<16;++l)o[a+l]=c[l];return o||Object(i.a)(c)};try{r.name=e}catch(e){}return r.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",r.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",r}},function(e,t,n){"use strict";var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=a(n(0)),o=a(n(12)),s=a(n(20));function a(e){return e&&e.__esModule?e:{default:e}}var c=window.location.protocol+"//chicoryapp.com",l=document.currentScript,u={native:o.default,segments:s.default},d=function(){function e(){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.components={},this.settings={},this.current_url="",Object.assign&&String.prototype.startsWith&&String.prototype.endsWith&&window.fetch)this.init();else{var t=document.createElement("script");t.type="text/javascript",t.async=!1,t.src="https://cdn.polyfill.io/v2/polyfill.js?rum=0&unknown=polyfill&features=Object.assign,String.prototype.startsWith,String.prototype.endsWith,fetch",t.onload=function(){this.init()}.bind(this),t.onerror=function(){throw new Error("Failed to polyfill needed features")},document.body.appendChild(t)}}return i(e,[{key:"init",value:function(){try{this.loading=!1;var e=window.ChicoryObject||"chicory",t=window[e];if(t)console.log("Chicory: running in SDK mode"),r.default.each(t.q,function(e,t){var n=[].slice.call(t);this[n.shift()].apply(this,n)}.bind(this));else{console.log("Chicory: running in standalone mode");var n=window.location.href,i=(0,r.default)("meta[property='og:url']");r.default.is_valid_url(i.attr("content"))&&i.length&&n&&new URL(n).hostname===new URL(i.attr("content")).hostname&&(n=i.attr("content"));var o=(0,r.default)("link[rel='canonical']");if(r.default.is_valid_url(o.attr("href"))&&1==o.length&&n&&new URL(n).hostname===new URL(o.attr("href")).hostname&&(n=o.attr("href")),!n)throw Error("Chicory cannot detect the page url.");r.default.ready(this.setRecipe.bind(this,n))}window[e]=function(){var e=[].slice.call(arguments);this[e.shift()].apply(this,e)}.bind(this),this.injectCSS()}catch(e){throw r.default.log(e),e}}},{key:"injectCSS",value:function(){var e=document.createElement("style");e.appendChild(document.createTextNode("@media print { .chicory-noprint { display: none !important; } }")),document.getElementsByTagName("head")[0].appendChild(e)}},{key:"resetComponents",value:function(){r.default.each(this.components,function(e,t){t.sdk.deactivate()})}},{key:"loadComponent",value:function(e){return new Promise(function(t,n){e.endpoint?r.default.script(e.endpoint).then(function(){e.sdk=window.Chicory[e.name].default,this.components[e.name]=e,t(e)}.bind(this)).catch(n):e.name in u?(e.sdk=u[e.name],this.components[e.name]=e,t(e)):n()}.bind(this))}},{key:"setRecipe",value:function(e){if(this.current_url!==e){var t=this;try{if(this.loading)return;if(this.loading=!0,this.resetComponents(),!e)return void(this.loading=!1);var n=r.default.extend({url:e},r.default.params(l.src));r.default.get(c+"/api/chicory",n).then(function(n){n.settings.host&&960===n.settings.host.id&&r.default.log(new Error("Yummly recipe lookup: "+n.ready));var i=localStorage.getItem("zip_code");i&&"null"!==i&&"undefined"!==i&&(n.settings.zip_code=i);var o=localStorage.getItem("country_code");o&&"null"!==o&&"undefined"!==o&&(n.settings.country_code=o),n.ready?(window.addEventListener("message",function(e){try{"chicory_iba_enabled"===JSON.parse(e.data).caller&&window.load_segments&&this.loadComponent({name:"segments"}).then(function(e){e.sdk.activate(n.settings)}).catch(r.default.done)}catch(e){}}.bind(this)),r.default.each(n.components,function(e,i){"segments"!==i.name?this.loadComponent(i).then(function(e){"ecommerce"===e.name?e.sdk.activate(t.getEcommerceSettings(n)):e.sdk.activate(n.settings)}).catch(r.default.done):window.load_segments=!0}.bind(this)),r.default.send("load_recipe",n.settings),this.current_url=e,this.loading=!1):this.loading=!1}.bind(this)).catch(r.default.done)}catch(e){r.default.log(e),console.log(e)}}}},{key:"setButtons",value:function(e){try{var t=this;r.default.get(c+"/api/sdk",{components:"ecommerce",pub_id:e.pub_id,button_copy:e.button_copy}).then(function(n){Object.keys(n.components).forEach(function(e){"analytics"===n.components[e].name&&(t.analytics=n.components[e]),"ecommerce"===n.components[e].name&&(t.ecommerce=n.components[e])}),t.setChicoryButtons(e,n.settings)}.bind(this)).catch(r.default.done)}catch(e){r.default.log(e),console.log(e)}}},{key:"setShopperSelect",value:function(e){try{var t=this;t.analytics={endpoint:c+"/sdk/analytics.js",name:"analytics"},this.loadComponent(this.analytics).then(function(e){r.default.extend({recipe:{},host:{}},t.settings),e.sdk.activate({recipe:{id:0,servings:0},host:{}})}).catch(r.default.done),t.shopperselect={endpoint:c+"/sdk/shopperselect.js",name:"shopperselect"},this.loadComponent(this.shopperselect).then(function(n){r.default.extend({recipe:{},host:{}},t.settings),n.sdk.activate(e)}).catch(r.default.done)}catch(e){r.default.log(e),console.log(e)}}},{key:"setChicoryButtons",value:function(e,t){try{if(this.loading)return;this.loading=!0,this.resetComponents();var n=e.pub_id,i=e.button_copy||"Buy Now",o=e.item_selector||".gridInfo",s=(e.button_container_selector,e.checkout_param_selector_tag_name||"h4"),a=document.querySelectorAll(o);this.loadComponent(this.analytics).then(function(e){r.default.extend({recipe:{},host:{}},c.settings),e.sdk.activate({recipe:{id:n,servings:0},is_mobile:t?t.is_mobile:null,host:{}})}).catch(r.default.done);var c=this;Object.keys(a).forEach(function(o){var l=a[o],u=l.getElementsByTagName(s)[0].innerText,d=[{search_query:u=l.getElementsByTagName(s)[0].getAttribute("data-query")?l.getElementsByTagName(s)[0].getAttribute("data-query"):u,measure:"count",text:null,ingredient:null}],f=l.getAttribute("id");f||(f="chicory_"+Math.random(),l.setAttribute("id",f));var h=[c.ecommerce],p={},g={id:n,servings:1,url:u,name:u,ingredient_lines:d},m=[],v={url:g.url,recipe:g,selector:""+f};e.button_container_selector&&(v.selector=e.button_container_selector),m.push(v),p.settings={type:"buy-buttons",recipe:g,recipes:m,host:{button_copy:i,id:n,button_template:"CLEAR",grocer_blacklist:["instacart","wholefoodsmarket","schnucks","smartandfinal","samsclub","vons","shaws","jewelosco","pavilions","starmarket","acmemarkets","safeway","albertsons","shoprite","instacart","meijer","walmart","amazon","peapod"]},location:"custom",cart:{options:{},analytics:{event:"buy_button_click",publisher_id:n,is_mobile:t?t.is_mobile:null},items:[{productSpecs:[{searchQuery:u}]}]}},p.components=h,r.default.each(p.components,function(e,t){c.loadComponent(t).then(function(e){r.default.extend(p.settings,c.settings),e.sdk.activate(p.settings)}).catch(r.default.done)}),r.default.send("load_recipe",p.settings)})}catch(e){r.default.log(e),console.log(e)}}},{key:"clearRecipes",value:function(){this.resetComponents()}},{key:"setRecipes",value:function(e){try{if(this.loading)return;if(this.loading=!0,this.resetComponents(),!e)throw new Error("Chicory: Missing recipes when looking up recipes.");if(e.length>1&&!this.settings.publisher_id)throw new Error("Chicory: Missing publisher_id when looking up multiple recipes.");var t={recipes:e};this.settings.publisher_id&&(t.publisher_id=this.settings.publisher_id),r.default.post(c+"/api/chicory",JSON.stringify(t)).then(function(e){var t=this;this.loading=!1,e.ready&&(r.default.each(e.components,function(n,i){this.loadComponent(i).then(function(n){r.default.extend(e.settings,t.settings),n.sdk.activate(e.settings)}).catch(r.default.done)}.bind(this)),r.default.send("load_recipe",e.settings))}.bind(this)).catch(r.default.done)}catch(e){r.default.log(e),console.log(e)}}},{key:"setOption",value:function(e,t){this.settings[e]=t}},{key:"getEcommerceSettings",value:function(e){var t=[];r.default.each(e.settings.recipe.ingredient_lines,function(e,n){t.push({text:n.text,ingredient:{name:n.ingredient+"",measure:n.measure+"",quantity:n.quantity},productSpecs:[{searchQuery:n.search_query,quantity:n.quantity,priority:0}]})});var n=[];return"company"in e.settings.host&&e.settings.host.company&&"brands"in e.settings.host.company&&(n=e.settings.host.company.brands),{recipe:{id:e.settings.recipe.id,name:e.settings.recipe.name,source_uri:e.settings.recipe.source_uri,source_image_uri:e.settings.recipe.source_image_uri,servings:e.settings.recipe.servings,is_mobile:e.settings.recipe.is_mobile,ingredient_lines:e.settings.recipe.ingredient_lines},host:e.settings.host,cart:{options:{retailer:{},blacklistedBrands:e.settings.host.brand_blacklist,blacklistedRetailers:e.settings.host.grocer_blacklist,preferredBrands:n,affiliateKeys:e.settings.host.affiliate_keys},items:t,analytics:{recipe_id:e.settings.recipe.id,zip_code:e.settings.zip_code,event:"ra_grocer_redirect",oauth_event:"ra_retailer_oauth",is_mobile:e.settings.is_mobile+""}},is_mobile:e.settings.is_mobile,country_code:e.settings.country_code,new_funnel:e.settings.new_funnel,zip_code:e.settings.zip_code}}}]),e}();window.__CHICORY__||(window.__CHICORY__=new d)},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(7),r=n(8);window.Promise.prototype.done=function(){this.catch(function(e){throw c.log(e),e})};var o=n(9),s=n(10);o.init({token:"e6d3166d-96cb-4e5d-8a52-da09bbede5e8"});class a{constructor(e=[]){this.elements=e}static select(e,t){return[].slice.call(e.querySelectorAll(t))}get length(){return this.elements.length}hide(){this.css("display","none")}show(){this.css("display","auto")}viewable(){let e=this.elements.filter(function(e){return e.offsetWidth>0||e.offsetHeight>0||e.getClientRects().length>0});return new a(e)}first(){return new a(this.elements.slice(0,1))}last(){return new a(this.elements.slice(-1))}parent(){let e=[];return this.elements.forEach(function(t){e=e.concat(t.parentElement)}),new a(e)}children(){let e=[];return this.elements.forEach(function(t){e=e.concat([].slice.call(t.children))}),new a(e)}find(e){let t=[];return this.elements.forEach(function(n){t=t.concat(a.select(n,e))}),new a(t)}width(){let e=this.elements.slice(0,1).pop();return e?e.getBoundingClientRect().width:0}height(){let e=this.elements.slice(0,1).pop();return e?e.getBoundingClientRect().height:0}css(e,t){if(void 0===t){let t=this.elements.slice(0,1).pop();return t?t.style[e]:null}return this.elements.forEach(function(n){n.style[e]=t}),this}attr(e,t){if(void 0===t){let t=this.elements.slice(0,1).pop();return t?t.getAttribute(e):null}return this.elements.forEach(function(n){t&&n.setAttribute(e,t)}),this}each(e){return this.elements.forEach(e),this}on(e,t){return this.elements.forEach(function(n){if("view"===e){let e=function(e){let i,r=n.getBoundingClientRect(),o=n.getAttribute("data-position")||"unknown";return i=r.bottom<=r.height/2?"above":r.top>=window.innerHeight-r.height/2?"below":"within",n.setAttribute("data-position",i),"unknown"===o&&["within","above"].indexOf(i)>-1?t(e):"below"===o&&"within"===i?t(e):void 0};window.addEventListener("scroll",e),e({})}n.addEventListener(e,t,!1)}),this}prepend(e){return this}append(e){return this.elements.forEach(function(t){e.each(function(e){t.appendChild(e)})}),this}before(e){return this}after(e){return this.elements.forEach(function(t){e.each(function(e){t.parentNode.insertBefore(e,t.nextSibling)})}),this}remove(){return this.elements.forEach(function(e){e.remove()}),this}}let c=function(e){if(e instanceof String||"string"==typeof e){if((e=e.trim()).startsWith("<")&&e.endsWith(">")){let t=document.createElement("template");return t.innerHTML=e,new a([t.content.firstChild])}return new a(a.select(document,e))}if(e instanceof HTMLDocument)return new a([e.documentElement]);if(e instanceof Node)return new a([e]);if(void 0===e)return new a;throw TypeError("Chicory: selector should be of type String or Node")};c.ready=function(e,t){let n=e.bind(window,t);if("loading"!==document.readyState)return void n();let i=document.onreadystatechange;document.onreadystatechange=function(){"loading"!==document.readyState&&(n(),i&&i())}},c.init=function(e){},c.log=function(e){console.log(e);try{let t={error:{name:e.name,message:e.message,stack:s.parse(e).map(function(e){return e.toString()})},page:{url:window.location.href,hostname:window.location.hostname,referrer:window.document.referrer,language:window.navigator.language||navigator.userLanguage,encoding:window.document.characterSet||window.document.defaultCharset},ua:navigator.userAgent};o.error(t)}catch(e){console.log(e)}},c.params=function(e){let t,n={},i=/[?&;](.+?)=([^&;]+)/g;if(!e)return{};for(;t=i.exec(e);)n[t[1]]=t[2];return n},c.query=function(e){if(!e)return"";let t=Object.keys(e).map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])}).join("&");return t?"?"+t:""},c.capitalize=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},c.get=function(e,t={},n={},i="json"){let r=new Request(e+c.query(t),c.extend({mode:"cors",credentials:"omit",redirect:"error",cache:"no-store"},n));return fetch(r).then(function(e){if(!e.ok)throw new Error("Network response was not ok: "+e.statusText);return e[i]()})},c.post=function(e,t={},n={},i="json"){let r={headers:{"Content-Type":"application/json"},method:"POST",body:t,mode:"cors",credentials:"omit",redirect:"error",cache:"no-store"},o=new Request(e,c.extend(r,n));return fetch(o).then(function(e){if(!e.ok)throw new Error("Network response was not ok: "+e.statusText);return e[i]()})},c.func=function(e,t){return new Function("return function (call) { return function "+e+" () { return call(this, arguments) }; };")()(Function.apply.bind(t))},c.named=function(e,t){return new Function("return function (call) { return function "+e+" () { return call(this, arguments) }; };")()(Function.apply.bind(t))},c.each=function(e,t){e instanceof Array?e.forEach(function(n,i){t.call(e,i,n)}):e instanceof Object&&Object.keys(e).forEach(function(n){t.call(e,n,e[n])})},c.extend=function(){return Object.assign.apply(this,arguments)},c.sanitize=function(e){return e&&""!==e?e.toLowerCase().replace(/[\r\n]+/g,"").replace(/\s+/g," ").replace(/^\s+|\s+$/,"").replace(/\(/g,"").replace(/\)/g,"").replace(/\*/g,"").replace(/\u21b5/g,"").trim():e},c.search=function(e,t,n=new a,i=0){return e.children().each(function(e){let r=c.sanitize(e.textContent);t=c.sanitize(t),r.length>0&&t.toLowerCase().trim().startsWith(r)&&(n=new a([e])),n.length<1&&i<3&&"wprm-recipe-ingredient"!=e.className&&(n=c.search(new a([e]),t,n,i++))}),n},c.fulltext=function(e,t,n){var i=new a,o={},s=r.a;if(s.load({}),e&&e.length>0){let t=0;e.elements.forEach(function(e){e&&function(e,t=0){let n=e;const i=[n];let r=0;for(;n=i.shift();){let e=t+"_"+r++;s.add(e,c.sanitize(n.textContent)),o[e]={element:n,type:n.tagName.toLowerCase()},Array.from(n.children).forEach(e=>{i.push(e)})}}(e,t),t++})}var l=c.sanitize(t),u=s.find(l);u.length<1&&(u=s.find(c.sanitize(n)));var d=u[u.length-1];return d?("span"===o[d].type&&u.forEach(function(e){"li"===o[e].type&&(d=e)}),o[d]&&(i=new a([o[d].element])),i):[]},c.goto=function(e){window.open(e)},c.getPageStructure=function(){let e={post:c(),recipe:c(),ingredients:c(),preps:c()};e.post=c(".entry-content, .post-content, .post_content, .post_article, .blog-yumprint-recipe, .recipe-single-instructions").viewable().first();let t=c(".wpurp-container").viewable().first();if(t.length)return e.recipe=t,e.ingredients=t.find(".wpurp-recipe-ingredients").viewable().first(),e.preps=t.find(".wpurp-recipe-instructions").viewable().first(),e;let n=c('[itemtype*="schema.org/Recipe"], #mpprecipe-ingredients-list').viewable().first();if(n.length&&!document.location.host.includes("halfbakedharvest"))return e.recipe=n,e.ingredients=n.find('[itemprop="ingredients"], [itemprop="recipeIngredient"]').viewable().parent().last(),e.preps=n.find("div#this_recipe > div.preps").viewable(),e;let i=c(".hrecipe").viewable().first();if(i.length)return e.recipe=i,e.ingredients=i.find(".ingredient").viewable().parent().last(),e;let r=c(".h-recipe").viewable().first();if(r.length)return e.recipe=r,e.ingredients=r.find(".p-ingredient").viewable().parent().last(),e.preps=r.find(".e-instructions").viewable(),e;let o=c(".recipe-single-container").viewable().last();if(o.length)return e.recipe=o,e.ingredients=o.find(".recipe-ingredients").viewable().first(),e.preps=o.find(".recipe-directions").viewable().first(),e;let s=c(".recipe-ingredients").viewable().first();if(s.length)return e.recipe=s,e.ingredients=s.find(".List").viewable(),e;let a=c(".tasty-recipes").viewable().first();if(a.length){e.recipe=a;let t=a.find(".tasty-recipe-ingredients").viewable().first();return t.elements.length?e.ingredients=t:e.ingredients=a.find(".tasty-recipes-ingredients").viewable().first(),e.preps=a.find(".tasty-recipe-instructions").viewable().first(),e}let l=c(".wprm-recipe-container").viewable().first();if(l.length)return e.recipe=l,e.ingredients=l.find(".wprm-recipe-ingredients-container").viewable().first(),e.preps=l.find(".wprm-recipe-instructions-container").viewable().first(),e;let u=c(".mv-recipe-card").viewable().first();if(u.length)return e.recipe=u,e.ingredients=u.find(".mv-create-ingredients").viewable().first(),e.preps=u.find(".mv-create-instructions").viewable().first(),e;let d=c(".rpr-ingredients-container").viewable().first();if(d.length)return e.recipe=d,e.ingredients=d.find(".rpr-ingredient-list").viewable().first(),e.preps=null,e;let f=c(".cooked-recipe-ingredients").viewable().first();if(f.length)return e.recipe=f,e.ingredients=f,e.preps=null,e;let h=c(".recipe-content").viewable().first();if(h.length)return e.recipe=h,e.ingredients=h.find(".ingredients-list").viewable().first(),e.ingredients.length||(e.ingredients=h.find(".ingredient-list").viewable().first()),e.preps=h.find(".directions-list").viewable().first(),e.preps.length||(e.preps=h.find(".numbered-direction-list").viewable().first()),e;let p=c(".Recipe").viewable().first();if(p.length)return e.recipe=p,e.ingredients=c(".Recipe__ingredientsGroups").viewable().first(),e.preps=c(".Recipe__instructionsGroup").viewable().first(),e;let g=c(".recipe-container").viewable().first();return g.length?(e.recipe=g,e.ingredients=g.find(".ingredient-lists").viewable().first(),e.preps=g.find(".directions").viewable().first(),e):e},c.script=function(e){return new Promise(function(t,n){let i=document.createElement("script");return i.type="text/javascript",i.async=!0,i.src=e,i.onload=t,i.onerror=n,document.body.appendChild(i),i})},c.iframe=function(e){return new Promise(function(t,n){let i=document.createElement("iframe");i.src=e,i.width="0",i.height="0",i.frameborder="0",i.style="display:none",i.onload=t,i.onerror=n,document.body.appendChild(i)})},c.image=function(e){return new Promise(function(t,n){let i=document.createElement("img");i.src=e,i.width="0",i.height="0",i.style="display:none",i.onload=t,i.onerror=n,document.body.appendChild(i)})},c.decode=function(e){let t=document.createElement("div");return t.innerHTML=e,0===t.childNodes.length?"":t.childNodes[0].nodeValue},c.listen=function(e,t){i.a.listen(e,t)},c.send=function(e,t){i.a.send(e,t)},c.is_valid_url=function(e){try{return new URL(e),!0}catch(e){return!1}},c.done=function(e){throw c.log(e),e},t.default=c},function(e,t,n){"use strict";t.a=new class{constructor(){this.queue={},this.$element=document.createElement("template")}send(e,t){e in this.queue||(this.queue[e]=[]),this.queue[e].push({name:e,data:t}),this.$element.dispatchEvent(new CustomEvent(e,{detail:t}))}listen(e,t){e in this.queue&&this.queue[e].forEach(function(e){t(e.data)}),this.$element.addEventListener(e,function(e){t(e.detail)})}}},function(e,t,n){"use strict";var i=function(){var e={a:"aⓐａẚàáâầấẫẩãāăằắẵẳȧǡäǟảåǻǎȁȃạậặḁąⱥɐ",aa:"ꜳ",ae:"æǽǣ",ao:"ꜵ",au:"ꜷ",av:"ꜹꜻ",ay:"ꜽ",b:"bⓑｂḃḅḇƀƃɓ",c:"cⓒｃćĉċčçḉƈȼꜿↄ",d:"dⓓｄḋďḍḑḓḏđƌɖɗꝺ",dz:"ǳǆ",e:"eⓔｅèéêềếễểẽēḕḗĕėëẻěȅȇẹệȩḝęḙḛɇɛǝ",f:"fⓕｆḟƒꝼ",g:"gⓖｇǵĝḡğġǧģǥɠꞡᵹꝿ",h:"hⓗｈĥḣḧȟḥḩḫẖħⱨⱶɥ",hv:"ƕ",i:"iⓘｉìíîĩīĭïḯỉǐȉȋịįḭɨı",j:"jⓙｊĵǰɉ",k:"kⓚｋḱǩḳķḵƙⱪꝁꝃꝅꞣ",l:"lⓛｌŀĺľḷḹļḽḻſłƚɫⱡꝉꞁꝇ",lj:"ǉ",m:"mⓜｍḿṁṃɱɯ",n:"nⓝｎǹńñṅňṇņṋṉƞɲŉꞑꞥ",nj:"ǌ",o:"oⓞｏòóôồốỗổõṍȭṏōṑṓŏȯȱöȫỏőǒȍȏơờớỡởợọộǫǭøǿɔꝋꝍɵ",oi:"ƣ",ou:"ȣ",oo:"ꝏ",p:"pⓟｐṕṗƥᵽꝑꝓꝕ",q:"qⓠｑɋꝗꝙ",r:"rⓡｒŕṙřȑȓṛṝŗṟɍɽꝛꞧꞃ",s:"sⓢｓśṥŝṡšṧṣṩșşȿꞩꞅẛ",ss:"ß",t:"tⓣｔṫẗťṭțţṱṯŧƭʈⱦꞇ",tz:"ꜩ",u:"uⓤｕùúûũṹūṻŭüǜǘǖǚủůűǔȕȗưừứữửựụṳųṷṵʉ",v:"vⓥｖṽṿʋꝟʌ",vy:"ꝡ",w:"wⓦｗẁẃŵẇẅẘẉⱳ",x:"xⓧｘẋẍ",y:"yⓨｙỳýŷỹȳẏÿỷẙỵƴɏỿ",z:"zⓩｚźẑżžẓẕƶȥɀⱬꝣ"},t={};for(var n in e)for(var i=e[n].split(""),r=0;r<i.length;++r)t[i[r]]=n;return t}();let r={minLength:2,substrings:!0,normalize:function(e){return function(e){for(var t=e.split(""),n="",r=0;r<t.length;++r){var o=t[r];n+=o in i?i[o]:o}return n}(e.toLowerCase())},split:function(e){return e.split(/[-\s,;:\.\/\\\{\}\[\]\(\)<>|!\?"'^#\+~\*\$%`´&§=@€»«¢„“”]+/)}};t.a=new class{constructor(e){this.options=r}find(e){var t=this.wordsOf(e);if(0===t.length)return[];t.sort(function(e,t){return t.length-e.length});var n=this.index,i=Object.prototype.hasOwnProperty,r=t[0];if(!i.call(n,r))return[];var o={};for(var s in n[r])o[s]=!0;for(var a=1;a<t.length;++a){if(r=t[a],!i.call(n,r))return[];var c=n[r];for(var s in o)i.call(c,s)||delete o[s]}return Object.keys(o)}add(e,t){var n=this.options.substrings?this.substringsOf(t):this.wordsOf(t);if(0===n.length)return!1;for(var i=this.index,r=Object.prototype.hasOwnProperty,o=0;o<n.length;++o){var s=n[o];(r.call(i,s)?i[s]:i[s]={})[e]=!0}return!0}remove(e){var t=this.index;for(var n in t)delete t[n][e]}clear(){this.index={}}wordsOf(e){var t=e.trim();if(!t)return[];var n=this.options.minLength,i={},r=Object.prototype.hasOwnProperty;return this.options.split(this.options.normalize(t)).filter(function(e){return!(e.length<n||r.call(i,e)||(i[e]=!0,0))})}substringsOf(e){for(var t=this.options.minLength,n=(Object.prototype.hasOwnProperty,this.wordsOf(e)),i={},r=0;r<n.length;++r)for(var o=n[r],s=o.length,a=s;a>=t;--a)for(var c=0,l=s-a;c<=l;++c)i[o.slice(c,c+a)]=!0;return Object.keys(i)}toJSON(){var e={},t=this.index;for(var n in t)e[n]=Object.keys(t[n]);return e}toString(){return JSON.stringify(this.toJSON())}dump(){return this.toString()}load(e){var t=e,n={};if("object"!=typeof t||null===t)throw new TypeError("invalid JSON data");for(var e in t){var i=t[e];if(!Array.isArray(i))throw new TypeError("invalid JSON data");for(var r={},o=0;o<i.length;++o){var s=i[o];if("string"!=typeof s)throw new TypeError("invalid JSON data");r[s]=!0}n[e]=r}this.index=n}}},function(e,t,n){var i;
/**
 * @license Copyright 2013 Logentries.
 * Please view license at https://raw.github.com/logentries/le_js/master/LICENSE
 */
/**
 * @license Copyright 2013 Logentries.
 * Please view license at https://raw.github.com/logentries/le_js/master/LICENSE
 */
!function(r,o){void 0===(i=function(){return o(r)}.call(t,n,t,e))||(e.exports=i)}(this,function(e){"use strict";function t(t){var n,i=(Math.random()+Math.PI).toString(36).substring(2,10),r=t.trace,o=t.page_info,s=t.token,a=t.print;n=e.LEENDPOINT?e.LEENDPOINT:"js.logentries.com/v1";var c="undefined"==typeof XDomainRequest?t.ssl:"https:"===e.location.protocol,l=[],u=!1,d=!1;if(t.catchall){var f=e.onerror;e.onerror=function(e,t,n){return h({error:e,line:n,location:t}).level("ERROR").send(),!!f&&f(e,t,n)}}var h=function(t){var n=function(){var e=Array.prototype.slice.call(arguments);if(0===e.length)throw new Error("No arguments!");return 1===e.length?e[0]:e}.apply(this,arguments),c={event:n};return"never"!==o&&(d&&"per-entry"!==o||(d=!0,void 0===n.screen&&void 0===n.browser&&h(function(){var t=e.navigator||{doNotTrack:void 0},n=e.screen||{};return{url:(e.location||{}).pathname,referrer:document.referrer,screen:{width:n.width,height:n.height},window:{width:e.innerWidth,height:e.innerHeight},browser:{name:t.appName,version:t.appVersion,cookie_enabled:t.cookieEnabled,do_not_track:t.doNotTrack},platform:t.platform}}()).level("PAGE").send())),r&&(c.trace=i),{level:function(e){if(a&&"undefined"!=typeof console&&"PAGE"!==e)try{console[e.toLowerCase()].call(console,c)}catch(e){console.log(c)}return c.level=e,{send:function(){var e=[],t=JSON.stringify(c,function(t,n){if(void 0===n)return"undefined";if("object"==typeof n&&null!==n){if(-1!==function(e,t){for(var n=0;n<e.length;n++)if(t===e[n])return n;return-1}(e,n))return"<?>";e.push(n)}return n});u?l.push(t):p(s,t)}}}}};this.log=h;var p=function(e,t){u=!0;var i="undefined"!=typeof XDomainRequest?new XDomainRequest:new XMLHttpRequest;i.constructor===XMLHttpRequest?i.onreadystatechange=function(){4===i.readyState&&(i.status>=400?(console.error("Couldn't submit events."),410===i.status&&console.warn("This version of le_js is no longer supported!")):(301===i.status&&console.warn("This version of le_js is deprecated! Consider upgrading."),l.length>0?p(e,l.shift()):u=!1))}:i.onload=function(){l.length>0?p(e,l.shift()):u=!1};var r=(c?"https://":"http://")+n+"/logs/"+s;i.open("POST",r,!0),i.constructor===XMLHttpRequest&&(i.setRequestHeader("X-Requested-With","XMLHttpRequest"),i.setRequestHeader("Content-type","text/json")),i.send(t)}}var n={},i=function(e){if("string"!=typeof e.name)throw new Error("Name not present.");if(n.hasOwnProperty(e.name))throw new Error("A logger with that name already exists!");return n[e.name]=new function(e){var n,i={ssl:!0,catchall:!1,trace:!0,page_info:"never",print:!1,endpoint:null,token:null};if("object"!=typeof e)throw new Error("Invalid parameters for createLogStream()");for(var r in e)i[r]=e[r];if(null===i.token)throw new Error("Token not present.");n=new t(i);var o=function(e){if(n)return n.log.apply(this,arguments);throw new Error("You must call LE.init(...) first.")};return{log:function(){o.apply(this,arguments).level("LOG").send()},warn:function(){o.apply(this,arguments).level("WARN").send()},error:function(){o.apply(this,arguments).level("ERROR").send()},info:function(){o.apply(this,arguments).level("INFO").send()}}}(e),!0};return{init:function(e){var t={name:"default"};if("object"==typeof e)for(var n in e)t[n]=e[n];else{if("string"!=typeof e)throw new Error("Invalid parameters for init()");t.token=e}return i(t)},createLogStream:i,to:function(e){if(!n.hasOwnProperty(e))throw new Error("Invalid name for logStream");return n[e]},destroy:function(e){void 0===e&&(e="default"),delete n[e]},log:function(){for(var e in n)n[e].log.apply(this,arguments)},warn:function(){for(var e in n)n[e].warn.apply(this,arguments)},error:function(){for(var e in n)n[e].error.apply(this,arguments)},info:function(){for(var e in n)n[e].info.apply(this,arguments)}}})},function(e,t,n){var i,r,o;!function(s,a){"use strict";r=[n(11)],void 0===(o="function"==typeof(i=a)?i.apply(t,r):i)||(e.exports=o)}(0,function(e){"use strict";var t=/(^|@)\S+\:\d+/,n=/^\s*at .*(\S+\:\d+|\(native\))/m,i=/^(eval@)?(\[native code\])?$/;return{parse:function(e){if(void 0!==e.stacktrace||void 0!==e["opera#sourceloc"])return this.parseOpera(e);if(e.stack&&e.stack.match(n))return this.parseV8OrIE(e);if(e.stack)return this.parseFFOrSafari(e);throw new Error("Cannot parse given Error object")},extractLocation:function(e){if(-1===e.indexOf(":"))return[e];var t=/(.+?)(?:\:(\d+))?(?:\:(\d+))?$/.exec(e.replace(/[\(\)]/g,""));return[t[1],t[2]||void 0,t[3]||void 0]},parseV8OrIE:function(t){return t.stack.split("\n").filter(function(e){return!!e.match(n)},this).map(function(t){t.indexOf("(eval ")>-1&&(t=t.replace(/eval code/g,"eval").replace(/(\(eval at [^\()]*)|(\)\,.*$)/g,""));var n=t.replace(/^\s+/,"").replace(/\(eval code/g,"(").split(/\s+/).slice(1),i=this.extractLocation(n.pop()),r=n.join(" ")||void 0,o=["eval","<anonymous>"].indexOf(i[0])>-1?void 0:i[0];return new e({functionName:r,fileName:o,lineNumber:i[1],columnNumber:i[2],source:t})},this)},parseFFOrSafari:function(t){return t.stack.split("\n").filter(function(e){return!e.match(i)},this).map(function(t){if(t.indexOf(" > eval")>-1&&(t=t.replace(/ line (\d+)(?: > eval line \d+)* > eval\:\d+\:\d+/g,":$1")),-1===t.indexOf("@")&&-1===t.indexOf(":"))return new e({functionName:t});var n=t.split("@"),i=this.extractLocation(n.pop()),r=n.join("@")||void 0;return new e({functionName:r,fileName:i[0],lineNumber:i[1],columnNumber:i[2],source:t})},this)},parseOpera:function(e){return!e.stacktrace||e.message.indexOf("\n")>-1&&e.message.split("\n").length>e.stacktrace.split("\n").length?this.parseOpera9(e):e.stack?this.parseOpera11(e):this.parseOpera10(e)},parseOpera9:function(t){for(var n=/Line (\d+).*script (?:in )?(\S+)/i,i=t.message.split("\n"),r=[],o=2,s=i.length;o<s;o+=2){var a=n.exec(i[o]);a&&r.push(new e({fileName:a[2],lineNumber:a[1],source:i[o]}))}return r},parseOpera10:function(t){for(var n=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,i=t.stacktrace.split("\n"),r=[],o=0,s=i.length;o<s;o+=2){var a=n.exec(i[o]);a&&r.push(new e({functionName:a[3]||void 0,fileName:a[2],lineNumber:a[1],source:i[o]}))}return r},parseOpera11:function(n){return n.stack.split("\n").filter(function(e){return!!e.match(t)&&!e.match(/^Error created at/)},this).map(function(t){var n,i=t.split("@"),r=this.extractLocation(i.pop()),o=i.shift()||"",s=o.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^\)]*\)/g,"")||void 0;o.match(/\(([^\)]*)\)/)&&(n=o.replace(/^[^\(]+\(([^\)]*)\)$/,"$1"));var a=void 0===n||"[arguments not available]"===n?void 0:n.split(",");return new e({functionName:s,args:a,fileName:r[0],lineNumber:r[1],columnNumber:r[2],source:t})},this)}}})},function(e,t,n){var i,r,o;!function(n,s){"use strict";r=[],void 0===(o="function"==typeof(i=s)?i.apply(t,r):i)||(e.exports=o)}(0,function(){"use strict";function e(e){return!isNaN(parseFloat(e))&&isFinite(e)}function t(e){return e.charAt(0).toUpperCase()+e.substring(1)}function n(e){return function(){return this[e]}}var i=["isConstructor","isEval","isNative","isToplevel"],r=["columnNumber","lineNumber"],o=["fileName","functionName","source"],s=i.concat(r,o,["args"],["evalOrigin"]);function a(e){if(e)for(var n=0;n<s.length;n++)void 0!==e[s[n]]&&this["set"+t(s[n])](e[s[n]])}a.prototype={getArgs:function(){return this.args},setArgs:function(e){if("[object Array]"!==Object.prototype.toString.call(e))throw new TypeError("Args must be an Array");this.args=e},getEvalOrigin:function(){return this.evalOrigin},setEvalOrigin:function(e){if(e instanceof a)this.evalOrigin=e;else{if(!(e instanceof Object))throw new TypeError("Eval Origin must be an Object or StackFrame");this.evalOrigin=new a(e)}},toString:function(){var e=this.getFileName()||"",t=this.getLineNumber()||"",n=this.getColumnNumber()||"",i=this.getFunctionName()||"";return this.getIsEval()?e?"[eval] ("+e+":"+t+":"+n+")":"[eval]:"+t+":"+n:i?i+" ("+e+":"+t+":"+n+")":e+":"+t+":"+n}},a.fromString=function(e){var t=e.indexOf("("),n=e.lastIndexOf(")"),i=e.substring(0,t),r=e.substring(t+1,n).split(","),o=e.substring(n+1);if(0===o.indexOf("@"))var s=/@(.+?)(?::(\d+))?(?::(\d+))?$/.exec(o,""),c=s[1],l=s[2],u=s[3];return new a({functionName:i,args:r||void 0,fileName:c,lineNumber:l||void 0,columnNumber:u||void 0})};for(var c=0;c<i.length;c++)a.prototype["get"+t(i[c])]=n(i[c]),a.prototype["set"+t(i[c])]=function(e){return function(t){this[e]=Boolean(t)}}(i[c]);for(var l=0;l<r.length;l++)a.prototype["get"+t(r[l])]=n(r[l]),a.prototype["set"+t(r[l])]=function(t){return function(n){if(!e(n))throw new TypeError(t+" must be a Number");this[t]=Number(n)}}(r[l]);for(var u=0;u<o.length;u++)a.prototype["get"+t(o[u])]=n(o[u]),a.prototype["set"+t(o[u])]=function(e){return function(t){this[e]=String(t)}}(o[u]);return a})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(e){return e&&e.__esModule?e:{default:e}}(n(0)),o=n(13);var s=window.location.protocol+"//chicoryapp.com",a="below-ingredient",c="below-ingredients",l="below-recipe",u="custom",d="none",f=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.settings={},this.device={},this.session=null,this.funnel=null,this.$pairing=null,this.$inlines=[],this.allowed_inlines=2,this.allowed_pairing=1,this.ad_refresh_count=1,this.ad_refresh_timer=null,this.original_settings=null,this._bound_device_init_listener=null}return i(e,[{key:"deactivate",value:function(){this.$pairing&&this.$pairing.remove(),r.default.each(this.$inlines,function(e,t){t.remove()}),this.settings={},this.device={},this.session=null,this.funnel=null,this.$pairing=null,this.$inlines=[],window.removeEventListener("message",this._bound_device_init_listener),this._bound_device_init_listener=null}},{key:"activate",value:function(e){this.original_settings=e,e.recipes||this.load(e).then(this.run.bind(this)).catch(r.default.done)}},{key:"load",value:function(e){var t=this;return new Promise(function(n){var i={host:e.host.id,recipe:e.recipe.id,zip_code:e.zip_code,dma_code:e.dma,state:e.state,country_code:e.country_code,is_mobile:e.is_mobile,refresh:t.ad_refresh_count};r.default.get(s+"/api/native",i).then(function(i){return r.default.extend(t.settings,e,i),n()}).catch(r.default.done),this._bound_device_init_listener=this._device_init_listener.bind(this),window.addEventListener("message",this._bound_device_init_listener,!1)}.bind(this))}},{key:"_device_init_listener",value:function(e){var t=new RegExp("e.chicoryapp.com".replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1"),"g");if(e.origin.match(t))try{var n=JSON.parse(e.data);"init"===n.caller&&(this.device=n.data.device,this.session=n.data.session,this.funnel=n.data.funnel)}catch(e){}}},{key:"reached_pairing_limit",value:function(){return!!(this.$pairing&&this.$pairing.length>=this.allowed_pairing)}},{key:"reached_inline_limit",value:function(){return!!(this.$inlines&&this.$inlines.length>=this.allowed_inlines)}},{key:"run",value:function(){for(var e=r.default.getPageStructure(),t=0,n=this.settings.ad_campaigns.length-1;n>0;n--){var i=Math.floor(Math.random()*(n+1)),o=[this.settings.ad_campaigns[i],this.settings.ad_campaigns[n]];this.settings.ad_campaigns[n]=o[0],this.settings.ad_campaigns[i]=o[1]}this.settings.ad_campaigns.sort(function(e,t){return e.priority<t.priority?1:-1}),r.default.each(this.settings.ad_campaigns,function(n,i){return!(this.settings.host.ad_campaign_limit&&t++>=this.settings.host.ad_campaign_limit)&&(("below-ingredient"!=i.selected_experiment.placement||!this.reached_inline_limit())&&(("below-ingredients"!=i.selected_experiment.placement||!this.reached_pairing_limit())&&void(this.injectCreative(e,i,i.selected_experiment.placement)||r.default.log(new Error("Chicory: Cannot inject ad creative (ID:"+i.selected_experiment.id+", LOCATION:"+i.selected_experiment.placement+").")))))}.bind(this)),this.handle_ad_refresh()}},{key:"is_serving_ads",value:function(){return(this.$inlines?this.$inlines.length:0)+(this.$pairing?this.$pairing.length:0)>0}},{key:"reached_refresh_limit",value:function(){return!(!this.settings.host.ad_refresh_limit||0===this.settings.host.ad_refresh_limit)&&(this.settings.host.ad_refresh_limit>0&&this.ad_refresh_count>=this.settings.host.ad_refresh_limit)}},{key:"is_in_viewport",value:function(e){for(var t=e.offsetTop,n=e.offsetLeft,i=e.offsetWidth,r=e.offsetHeight;e.offsetParent;)t+=(e=e.offsetParent).offsetTop,n+=e.offsetLeft;return t<window.pageYOffset+window.innerHeight&&n<window.pageXOffset+window.innerWidth&&t+r>window.pageYOffset&&n+i>window.pageXOffset}},{key:"is_any_ad_unit_in_viewport",value:function(){for(var e=0;e<this.$inlines.length;e++)for(var t=0;t<this.$inlines.length;t++)if(this.$inlines[e].elements[t]&&this.is_in_viewport(this.$inlines[e].elements[t]))return!0;return!(!(this.$pairing?this.$pairing.length:0)||!this.is_in_viewport(this.$pairing.elements[0]))}},{key:"refresh_ads",value:function(){var e=this.device,t=this.session,n=this.funnel;this.deactivate(),this.activate(this.original_settings),this.device=e,this.session=t,this.funnel=n}},{key:"ad_refresh_set_timer",value:function(){var e=this;return setTimeout(function(){e.is_any_ad_unit_in_viewport()?e.refresh_ads():e.ad_refresh_timer=e.ad_refresh_set_timer()},1e3*this.settings.host.ad_refresh_seconds)}},{key:"handle_ad_refresh",value:function(){var e=this;this.settings.host.ad_refresh_active&&!this.reached_refresh_limit()?this.ad_refresh_timer=this.ad_refresh_set_timer():this.ad_refresh_timer=null,this.is_serving_ads()&&(this.ad_refresh_count+=1);var t=void 0;void 0!==document.hidden?t="hidden":void 0!==document.msHidden?t="msHidden":void 0!==document.webkitHidden&&(t="webkitHidden"),document.addEventListener("visibilitychange",function(){document[t]?clearTimeout(e.ad_refresh_timer):e.ad_refresh_timer=e.ad_refresh_set_timer()})}},{key:"injectCreative",value:function(e,t,n){var i=(0,r.default)(t.selected_experiment.html);if(i.firstViewed=!1,!document.getElementById(i.elements[0].id)){var s=(0,r.default)("div.chicory-peek").viewable();s.length&&(n=u);var f=!t.selected_experiment.placement;switch(n){case a:var h=[];if(t.matched_ingredient_line&&(h=r.default.fulltext(e.ingredients,t.matched_ingredient_line,t.matched_ingredient)),!h.length&&t.matched_ingredient_line&&(h=r.default.fulltext(e.ingredients,r.default.decode(t.matched_ingredient_line),t.matched_ingredient)),!h.length&&t.matched_ingredient_line&&(h=r.default.fulltext((0,r.default)("ul").viewable(),t.matched_ingredient_line,t.matched_ingredient)),!h.length)return this.injectCreative(e,t,f?c:d);if(this.$inlines.length>=3)return this.injectCreative(e,t,f?c:d);h.append(i),this.$inlines.push(i);break;case c:var p=e.ingredients;if(!p.length)return this.injectCreative(e,t,f?l:d);if(this.$pairing)return this.injectCreative(e,t,f?l:d);p.append(i),this.$pairing=i;break;case l:var g=e.recipe;if(!g.length)return this.injectCreative(e,t,d);if(this.$pairing)return this.injectCreative(e,t,d);g.append(i),this.$pairing=i;break;case u:if(!s.length)return this.injectCreative(e,t,d);if(this.$pairing)return this.injectCreative(e,t,d);s.append(i),this.$pairing=i;break;case d:return;default:return this.injectCreative(e,t,a)}var m=i.parent().width();m<i.width()&&i.width(m),m<150&&i.hide();var v={ad_campaign_id:t.id,ad_campaign_name:t.name,ad_campaign_test_id:t.selected_experiment.id,ad_campaign_test_name:t.selected_experiment.name,ad_campaign_group_id:t.group.id,ad_campaign_group_name:t.group.name,ad_campaign_width:i.width(),ad_campaign_height:i.height(),parent_width:i.parent().width(),parent_height:i.parent().height(),ad_not_shown:!i.viewable().length,location:n,zip_code:t.zip_code,ad_refresh_count:this.ad_refresh_count},w=(0,o.v4)();return v.funnel_id=w,i.on("view",function(e){var n=t.selected_experiment.impression_tracker;if(n){for(n="<div>"+n+"</div>";null!==n.match(/\[RANDOM_NUMBER]/g);)n=n.replace(/\[RANDOM_NUMBER]/,Math.random());var o=(0,r.default)(n);i.after(o.css("display","none"))}var s=t.selected_experiment.script_tracker,a=/<script[a-z1-9"'\/ =]*?src="(.*?)"/gim;if(s&&!i.firstViewed){for(var c=void 0;null!==(c=a.exec(s));){c.index===a.lastIndex&&a.lastIndex++;var l=document.createElement("script");l.type="text/javascript",l.src=c[1],r.default.each(i.elements,function(e,t){t.appendChild(l)})}i.firstViewed=!0}r.default.send("view_campaign",v)}.bind(this)),i.on("click",function(e){e.preventDefault();var n=t.selected_experiment.target_url,i=n.indexOf("http")<0?window.location.protocol+"//"+n:n,o=this.generate_redirect_hash(v,i,"click_campaign");r.default.goto("//e.chicoryapp.com/api/r?data="+o)}.bind(this)),r.default.send("load_campaign",v),console.log("Chicory: injecting native creative at location: "+n),n}}},{key:"generate_redirect_hash",value:function(e,t,n){var i={url:t,is_mobile:this.settings.is_mobile};for(var o in e)e.hasOwnProperty(o)&&(i[o]=e[o]);var s=new Date((new Date).toUTCString()).getTime(),a={uuid:this.device.uuid,session_id:this.session.id,funnel_id:e.funnel_id,name:n,recipe_id:this.settings.recipe.id,viewport_height:(0,r.default)(window.document).height(),viewport_width:(0,r.default)(window.document).width(),language:window.navigator.language||navigator.userLanguage,encoding:window.document.characterSet||window.document.defaultCharset,url:window.document.location.href,referrer:window.document.referrer,duration:s-(window.performance?window.performance.timing.domContentLoadedEventEnd:LOAD_TIME),client_timestamp:s,properties:r.default.extend({},this.device.properties,this.session.properties,this.funnel.properties,i||{})};delete a.properties.funnel_id;var c=JSON.stringify(a);return btoa(c)}},{key:"generate_redirect_form",value:function(e,t){var n=document.createElement("form"),i=function(e,t){n.setAttribute(e,t)};i("enctype","application/json"),i("method","post"),i("action","http://e.chicoryapp.com/api/event"),i("target","_blank");var r=function(e,t){var i=document.createElement("input");i.setAttribute("type","hidden"),i.setAttribute("name",e),i.setAttribute("value",t),n.appendChild(i)};return r("data",JSON.stringify(e)),r("redirect",t),n}}]),e}();t.default=new f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(14);n.d(t,"v1",function(){return i.a});var r=n(15);n.d(t,"v3",function(){return r.a});var o=n(17);n.d(t,"v4",function(){return o.a});var s=n(18);n.d(t,"v5",function(){return s.a})},function(e,t,n){"use strict";var i,r,o=n(2),s=n(1),a=0,c=0;t.a=function(e,t,n){var l=t&&n||0,u=t||[],d=(e=e||{}).node||i,f=void 0!==e.clockseq?e.clockseq:r;if(null==d||null==f){var h=e.random||(e.rng||o.a)();null==d&&(d=i=[1|h[0],h[1],h[2],h[3],h[4],h[5]]),null==f&&(f=r=16383&(h[6]<<8|h[7]))}var p=void 0!==e.msecs?e.msecs:(new Date).getTime(),g=void 0!==e.nsecs?e.nsecs:c+1,m=p-a+(g-c)/1e4;if(m<0&&void 0===e.clockseq&&(f=f+1&16383),(m<0||p>a)&&void 0===e.nsecs&&(g=0),g>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");a=p,c=g,r=f;var v=(1e4*(268435455&(p+=122192928e5))+g)%4294967296;u[l++]=v>>>24&255,u[l++]=v>>>16&255,u[l++]=v>>>8&255,u[l++]=255&v;var w=p/4294967296*1e4&268435455;u[l++]=w>>>8&255,u[l++]=255&w,u[l++]=w>>>24&15|16,u[l++]=w>>>16&255,u[l++]=f>>>8|128,u[l++]=255&f;for(var _=0;_<6;++_)u[l+_]=d[_];return t||Object(s.a)(u)}},function(e,t,n){"use strict";var i=n(3),r=n(16),o=Object(i.a)("v3",48,r.a);t.a=o},function(e,t,n){"use strict";function i(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function r(e,t,n,r,o,s){return i(function(e,t){return e<<t|e>>>32-t}(i(i(t,e),i(r,s)),o),n)}function o(e,t,n,i,o,s,a){return r(t&n|~t&i,e,t,o,s,a)}function s(e,t,n,i,o,s,a){return r(t&i|n&~i,e,t,o,s,a)}function a(e,t,n,i,o,s,a){return r(t^n^i,e,t,o,s,a)}function c(e,t,n,i,o,s,a){return r(n^(t|~i),e,t,o,s,a)}t.a=function(e){if("string"==typeof e){var t=unescape(encodeURIComponent(e));e=new Array(t.length);for(var n=0;n<t.length;n++)e[n]=t.charCodeAt(n)}return function(e){var t,n,i,r=[],o=32*e.length;for(t=0;t<o;t+=8)n=e[t>>5]>>>t%32&255,i=parseInt("0123456789abcdef".charAt(n>>>4&15)+"0123456789abcdef".charAt(15&n),16),r.push(i);return r}(function(e,t){var n,r,l,u,d;e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;var f=1732584193,h=-271733879,p=-1732584194,g=271733878;for(n=0;n<e.length;n+=16)r=f,l=h,u=p,d=g,f=o(f,h,p,g,e[n],7,-680876936),g=o(g,f,h,p,e[n+1],12,-389564586),p=o(p,g,f,h,e[n+2],17,606105819),h=o(h,p,g,f,e[n+3],22,-1044525330),f=o(f,h,p,g,e[n+4],7,-176418897),g=o(g,f,h,p,e[n+5],12,1200080426),p=o(p,g,f,h,e[n+6],17,-1473231341),h=o(h,p,g,f,e[n+7],22,-45705983),f=o(f,h,p,g,e[n+8],7,1770035416),g=o(g,f,h,p,e[n+9],12,-1958414417),p=o(p,g,f,h,e[n+10],17,-42063),h=o(h,p,g,f,e[n+11],22,-1990404162),f=o(f,h,p,g,e[n+12],7,1804603682),g=o(g,f,h,p,e[n+13],12,-40341101),p=o(p,g,f,h,e[n+14],17,-1502002290),h=o(h,p,g,f,e[n+15],22,1236535329),f=s(f,h,p,g,e[n+1],5,-165796510),g=s(g,f,h,p,e[n+6],9,-1069501632),p=s(p,g,f,h,e[n+11],14,643717713),h=s(h,p,g,f,e[n],20,-373897302),f=s(f,h,p,g,e[n+5],5,-701558691),g=s(g,f,h,p,e[n+10],9,38016083),p=s(p,g,f,h,e[n+15],14,-660478335),h=s(h,p,g,f,e[n+4],20,-405537848),f=s(f,h,p,g,e[n+9],5,568446438),g=s(g,f,h,p,e[n+14],9,-1019803690),p=s(p,g,f,h,e[n+3],14,-187363961),h=s(h,p,g,f,e[n+8],20,1163531501),f=s(f,h,p,g,e[n+13],5,-1444681467),g=s(g,f,h,p,e[n+2],9,-51403784),p=s(p,g,f,h,e[n+7],14,1735328473),h=s(h,p,g,f,e[n+12],20,-1926607734),f=a(f,h,p,g,e[n+5],4,-378558),g=a(g,f,h,p,e[n+8],11,-2022574463),p=a(p,g,f,h,e[n+11],16,1839030562),h=a(h,p,g,f,e[n+14],23,-35309556),f=a(f,h,p,g,e[n+1],4,-1530992060),g=a(g,f,h,p,e[n+4],11,1272893353),p=a(p,g,f,h,e[n+7],16,-155497632),h=a(h,p,g,f,e[n+10],23,-1094730640),f=a(f,h,p,g,e[n+13],4,681279174),g=a(g,f,h,p,e[n],11,-358537222),p=a(p,g,f,h,e[n+3],16,-722521979),h=a(h,p,g,f,e[n+6],23,76029189),f=a(f,h,p,g,e[n+9],4,-640364487),g=a(g,f,h,p,e[n+12],11,-421815835),p=a(p,g,f,h,e[n+15],16,530742520),h=a(h,p,g,f,e[n+2],23,-995338651),f=c(f,h,p,g,e[n],6,-198630844),g=c(g,f,h,p,e[n+7],10,1126891415),p=c(p,g,f,h,e[n+14],15,-1416354905),h=c(h,p,g,f,e[n+5],21,-57434055),f=c(f,h,p,g,e[n+12],6,1700485571),g=c(g,f,h,p,e[n+3],10,-1894986606),p=c(p,g,f,h,e[n+10],15,-1051523),h=c(h,p,g,f,e[n+1],21,-2054922799),f=c(f,h,p,g,e[n+8],6,1873313359),g=c(g,f,h,p,e[n+15],10,-30611744),p=c(p,g,f,h,e[n+6],15,-1560198380),h=c(h,p,g,f,e[n+13],21,1309151649),f=c(f,h,p,g,e[n+4],6,-145523070),g=c(g,f,h,p,e[n+11],10,-1120210379),p=c(p,g,f,h,e[n+2],15,718787259),h=c(h,p,g,f,e[n+9],21,-343485551),f=i(f,r),h=i(h,l),p=i(p,u),g=i(g,d);return[f,h,p,g]}(function(e){var t,n=[];for(n[(e.length>>2)-1]=void 0,t=0;t<n.length;t+=1)n[t]=0;var i=8*e.length;for(t=0;t<i;t+=8)n[t>>5]|=(255&e[t/8])<<t%32;return n}(e),8*e.length))}},function(e,t,n){"use strict";var i=n(2),r=n(1);t.a=function(e,t,n){var o=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var s=(e=e||{}).random||(e.rng||i.a)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t)for(var a=0;a<16;++a)t[o+a]=s[a];return t||Object(r.a)(s)}},function(e,t,n){"use strict";var i=n(3),r=n(19),o=Object(i.a)("v5",80,r.a);t.a=o},function(e,t,n){"use strict";function i(e,t,n,i){switch(e){case 0:return t&n^~t&i;case 1:return t^n^i;case 2:return t&n^t&i^n&i;case 3:return t^n^i}}function r(e,t){return e<<t|e>>>32-t}t.a=function(e){var t=[1518500249,1859775393,2400959708,3395469782],n=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){var o=unescape(encodeURIComponent(e));e=new Array(o.length);for(var s=0;s<o.length;s++)e[s]=o.charCodeAt(s)}e.push(128);var a=e.length/4+2,c=Math.ceil(a/16),l=new Array(c);for(s=0;s<c;s++){l[s]=new Array(16);for(var u=0;u<16;u++)l[s][u]=e[64*s+4*u]<<24|e[64*s+4*u+1]<<16|e[64*s+4*u+2]<<8|e[64*s+4*u+3]}for(l[c-1][14]=8*(e.length-1)/Math.pow(2,32),l[c-1][14]=Math.floor(l[c-1][14]),l[c-1][15]=8*(e.length-1)&4294967295,s=0;s<c;s++){for(var d=new Array(80),f=0;f<16;f++)d[f]=l[s][f];for(f=16;f<80;f++)d[f]=r(d[f-3]^d[f-8]^d[f-14]^d[f-16],1);var h=n[0],p=n[1],g=n[2],m=n[3],v=n[4];for(f=0;f<80;f++){var w=Math.floor(f/20),_=r(h,5)+i(w,p,g,m)+v+t[w]+d[f]>>>0;v=m,m=g,g=r(p,30)>>>0,p=h,h=_}n[0]=n[0]+h>>>0,n[1]=n[1]+p>>>0,n[2]=n[2]+g>>>0,n[3]=n[3]+m>>>0,n[4]=n[4]+v>>>0}return[n[0]>>24&255,n[0]>>16&255,n[0]>>8&255,255&n[0],n[1]>>24&255,n[1]>>16&255,n[1]>>8&255,255&n[1],n[2]>>24&255,n[2]>>16&255,n[2]>>8&255,255&n[2],n[3]>>24&255,n[3]>>16&255,n[3]>>8&255,255&n[3],n[4]>>24&255,n[4]>>16&255,n[4]>>8&255,255&n[4]]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(e){return e&&e.__esModule?e:{default:e}}(n(0));var o=window.location.protocol+"//chicoryapp.com",s={crosspixel:{name:"crosspixel",url:"//tag.crsspxl.com/s1.js?d=[PIXEL_CODE]&cb=[DATE]",type:"script"},ignitionone:{name:"ignitionone",url:"//chico.netmng.com/?aid=4640&siclientid=&tax=[PIXEL_CODE]&cch",type:"script"},mediamath:{name:"mediamath",url:"//pixel.mathtag.com/data/img?mt_id=[PIXEL_CODE]&v1=&v2=&v3=&s1=&s2=&s3=",type:"image"},quantcast:{name:"quantcast",url:"https://secure.quantserve.com/quant.js",type:"script",callback:function(e,t,n){"load_recipe"===e&&(window._qevents=window._qevents||[],window._qevents.push({qacct:n.pixel,labels:"Publisher."+t.host.name.replace(/,/g,"|").replace(/\./g,"_")}))}},dbm:{name:"dbm",url:"//3792445.fls.doubleclick.net/activityi;src=3792445;type=chico0;cat=[PIXEL_CODE];dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=[DATE]?",type:"iframe"}},a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.settings={}}return i(e,[{key:"deactivate",value:function(){this.settings={}}},{key:"activate",value:function(e){e.chicory_opt_out?console.log("Chicory IBA opt-out cookie present"):e.recipes||this.load(e).then(this.run.bind(this)).catch(r.default.done)}},{key:"load",value:function(e){var t=this;return new Promise(function(n){var i={recipe:e.recipe.id};r.default.get(o+"/api/segments",i).then(function(i){return r.default.extend(t.settings,e,i),n()}).catch(r.default.done)}.bind(this))}},{key:"run",value:function(){r.default.each(this.settings.segments,function(e,t){this.injectPixel(t)}.bind(this)),r.default.each(this.settings.cookies,function(e,t){this.injectCookie(t)}.bind(this))}},{key:"injectPixel",value:function(e){if(e.dsp in s){var t=s[e.dsp],n=r.default[t.type],i=(new Date).getTime();r.default.each(e.trigger_events,function(o,s){r.default.listen(s,function(o){var a=t.url.replace("[DATE]",i).replace("[PIXEL_CODE]",e.pixel),c=n(a);t.callback&&c.then(t.callback.bind(this,s,o,e)).catch(r.default.done),r.default.send("load_segment",{}),console.log("Chicory: injecting audience segment pixel")})})}}},{key:"injectCookie",value:function(e){r.default.send("load_cookie",e),console.log("Chicory: injecting cookie sync pixel")}}]),e}();t.default=new a}]);
//# sourceMappingURL=wrapper.full.ff3f15a13dd1caa09f7c.min.js.map